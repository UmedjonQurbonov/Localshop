{% extends "base.html" %}
{% block title %}Оформление заказа{% endblock %}

{% block content %}
<div style="max-width: 900px; margin: 50px auto; padding: 40px; background: #faf8ff; border-radius: 28px; box-shadow: 0 20px 70px rgba(180, 150, 255, 0.25); position: relative; overflow: hidden;">
  

  <div style="position: absolute; inset: 0; background: radial-gradient(circle at 30% 30%, rgba(180,150,255,0.15) 0%, transparent 50%), radial-gradient(circle at 70% 80%, rgba(200,150,255,0.15) 0%, transparent 50%); pointer-events: none;"></div>
  
  <style>
    @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
    @keyframes shine { 0% { background-position: -200%; } 100% { background-position: 200%; } }
  </style>

  <h2 style="text-align: center; font-size: 3rem; background: linear-gradient(90deg, #a78bff, #c9a7ff, #e0c3ff, #a78bff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 45px; font-weight: 800;">
    Подтверждение заказа
  </h2>

  {% if items %}
    <div style="background: white; border-radius: 24px; overflow: hidden; border: 1px solid rgba(180,150,255,0.3); box-shadow: 0 15px 40px rgba(180,150,255,0.15);">
      <table style="width: 100%; color: #333;">
        <thead>
          <tr style="background: linear-gradient(90deg, #b8a0ff, #d4b8ff); color: #4a2c8a; height: 70px; font-weight: 700;">
            <th style="padding: 20px; text-align: left;">Товар</th>
            <th style="padding: 20px; text-align: center;">Кол-во</th>
            <th style="padding: 20px; text-align: right;">Цена</th>
            <th style="padding: 20px; text-align: right;">Сумма</th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
          <tr style="border-bottom: 1px solid #f0e6ff; transition: all 0.3s;">
            <td style="padding: 25px 20px;">
              <div style="font-size: 1.35rem; font-weight: 600; color: #5a3a9e;">{{ item.product.name }}</div>
              {% if item.product.sku %}
                <div style="color: #999; font-size: 0.95rem; margin-top: 6px;">Арт: {{ item.product.sku }}</div>
              {% endif %}
            </td>
            <td style="padding: 25px; text-align: center;">
              <span style="display: inline-block; width: 56px; height: 56px; line-height: 56px; background: linear-gradient(135deg, #c9a7ff, #e0c3ff); color: #4a2c8a; border-radius: 50%; font-weight: 900; font-size: 1.5rem; box-shadow: 0 8px 25px rgba(180,150,255,0.4);">
                {{ item.quantity }}
              </span>
            </td>
            <td style="padding: 25px; text-align: right; font-weight: 600;">
              {{ item.product.price|floatformat:0 }} сомони
            </td>
            <td style="padding: 25px; text-align: right; font-size: 1.5rem; font-weight: 800; color: #8a4bff;">
              {{ item.total_price|floatformat:0 }} сомони
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div style="text-align: center; margin: 60px 0 50px;">
      <div style="font-size: 1.8rem; color: #777; margin-bottom: 12px; font-weight: 500;">Итого к оплате</div>
      <div style="font-size: 5.5rem; font-weight: 900; background: linear-gradient(90deg, #a78bff, #c9a7ff, #8a4bff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: shine 4s linear infinite; background-size: 200% 200%;">
        {{ total_price|floatformat:0 }} сомони
      </div>
    </div>
    <div style="text-align: center;">
      <form method="post" style="display: inline-block;">
        {% csrf_token %}
        <button type="submit" style="
          padding: 22px 90px;
          font-size: 2rem;
          font-weight: 800;
          background: linear-gradient(135deg, #b8a0ff, #d4b8ff, #a78bff);
          color: white;
          border: none;
          border-radius: 50px;
          cursor: pointer;
          box-shadow: 0 15px 45px rgba(180,150,255,0.5);
          transition: all 0.4s;
          text-transform: uppercase;
          letter-spacing: 2px;
          position: relative;
          overflow: hidden;
        "
        onmouseover="this.style.transform='translateY(-5px) scale(1.05)'; this.style.boxShadow='0 25px 60px rgba(180,150,255,0.7)'"
        onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 15px 45px rgba(180,150,255,0.5)'">
          <span style="position: relative; z-index: 2;">Подтвердить заказ</span>
          <div style="position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); animation: shine 3s infinite;"></div>
        </button>
      </form>

      <div style="margin-top: 30px;">
        <a href="{% url 'cart' %}" style="color: #999; text-decoration: none; font-size: 1.1rem;">
          ← Назад в корзину
        </a>
      </div>
    </div>

  {% else %}
    <div style="text-align: center; padding: 120px 20px; color: #888;">
      <h2 style="font-size: 3.2rem; margin-bottom: 20px; color: #b8a0ff;">Корзина пуста</h2>
      <p style="font-size: 1.4rem;">Но это легко исправить</p>
      <a href="{% url 'shop:product_list' %}" style="margin-top: 35px; display: inline-block; padding: 18px 60px; background: linear-gradient(135deg, #c9a7ff, #e0c3ff); border-radius: 50px; color: #4a2c8a; font-size: 1.5rem; font-weight: 700; text-decoration: none; box-shadow: 0 10px 30px rgba(180,150,255,0.3);">
        В каталог за красотой
      </a>
    </div>
  {% endif %}
</div>
{% endblock %}